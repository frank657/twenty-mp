<!--pages/events/show/show.wxml-->
<navbar navType='float' />

<image src="{{event.image}}" mode="aspectFill" class="w100 fixed" style="height: 500rpx;"/>

<view class="relative bg-white w100 py50 px40 box-b" style="top: 450rpx; border-radius: 40rpx 40rpx 0 0; overflow: hidden;">

  <view class="row-between" style="align-items: flex-start;">
    <view class="">
      <view class="bold f40 mb40 pri">{{event.title}}</view>
      <view class="f32 grey mb">{{event.ui_date[0]}}</view>
      <view class="f32 grey">{{event.ui_date[1]}}</view>
    </view>
    <image mode="aspectFill" 
      class="ml20"
      style="height: 100rpx; width: 100rpx; border-radius: 35%; flex-shrink: 0;" 
      src="{{creator.avatar}}"></image>
  </view>

  <view class="row-start mt30 w100" bindtap="openMap">
    <image src="/images/icons/map-pin.svg" class="icon-mini mr20" mode="aspectFit"></image>
    <view class="row-start">
      <view class="f32 grey">{{event.venue_name}}</view>
      <view wx:if="{{event.longitude&&event.latitude}}" 
        class="f24 ter px20 py bg-dim ml30 radius10" style="flex-shrink: 0;">see map</view>
    </view>
  </view>

  <view class="row-between w100 mt50 mb100">
    <navigator 
      url="/pages/events/attendees/attendees"
      class="row-start">
      <block wx:for="{{[event.attendees.yes[0], event.attendees.yes[1], event.attendees.yes[2], event.attendees.yes[3]]}}">
        <image wx:if="{{item}}"
          class="mr20"
          src="{{item.avatar}}"
          style="width: 80rpx; height: 80rpx; border-radius: 35%;"></image>
      </block>

      <view wx:if="{{event.attendees.yes.length>4||!event.attendees.yes.length}}"
        style="height: 80rpx; width: 80rpx; border-radius: 35%;" 
        class="bg-dim ter row-center mr20">
        {{event.attendees.yes.length>3?event.attendees.yes.length-3:0}}
        </view>

      <!-- <view style="height: 80rpx; width: 80rpx; border-radius: 35%;" 
        class="bg-dim ter row-center f24">
        list
        </view> -->

    </navigator>
    <button open-type="share" class="unset-btn" style="margin-right: 0;">
      <image src="/images/icons/share.svg" 
        style="width: 50rpx; height: 50rpx;" 
        mode="aspectFit"></image>
    </button>
  </view>
  
  <view>
    <view class="bold f32 ter mb40">Description</view>
    <text class="grey f28">{{event.description}}</text>
  </view>

  <view style="height: 150rpx;"/>


</view>
<view class="row-between show-footer bg-white">

  <view wx:if="{{userInfo.id == creator.id}}" class="absolute" style="right: 40rpx; top: -180rpx;">
    <view wx:if="{{showMore}}" style="top: -130rpx;" bindtap="deleteEvent"
      class="absolute bg-sec row-center white f24 bold float-btn transition-3">
      cancel
    </view>
    <navigator wx:if="{{showMore}}" style="left: -130rpx;" url="/pages/events/edit/edit?id={{event.id}}"
      class="absolute bg-sec row-center white f24 bold float-btn transition-3">
      edit
    </navigator>
    <view class="bg-sec row-center white f24 bold {{showMore?'':'opacity-3'}} transition-3 float-btn" 
      style="{{showMore?'box-shadow: 0px 5px 20px rgba(255, 201, 60, 0.7)':''}};"
      bindtap="clickMore">
      {{showMore?'hide':'more'}}
    </view>
  </view>

  <view class="bold ter f28 mr50">Joining?</view>
  <!-- <view wx:for="{{answers}}"
    class="pa20 bold transition-3 {{attending_status==item.name?'bg-sec white':'grey-light'}}" 
    style="border-radius: 30rpx;" bindtap="join" data-answer="{{item.name}}">{{item.label}}</view> -->
  <button
    open-type="getUserInfo"
    bindgetuserinfo="join"
    wx:for="{{answers}}"
    class="pa20 bold transition-3 {{attending_status==item.name?'bg-sec white':'grey-light bg-white'}}" 
    style="border-radius: 30rpx; min-height: unset !important; width: unset !important; margin-right: 0;" 
    data-answer="{{item.name}}">{{item.label}}</button>
</view>

